<!DOCTYPE html>
  <html>
    <head>
      <meta charset="utf-8">
      <title>WoodPC - Администратор</title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      <!--Import Google Icon Font-->
      <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      <script type="text/javascript" src="js/materialize.min.js"></script>
      <link type="text/css" rel="stylesheet" href="css/style.css"  media="screen,projection"/>
      <script src="js/vue.js"></script>
    </head>

    <body>
      <!--Верхнее меню-->
      <div class="navbar-fixed">
        <nav class="nav-extended red darken-4">
          <div class="nav-wrapper">
            <a href="/" class="brand-logo right hide-on-med-and-down">Администратор ООО "WoodPC"</a>
            <a data-activates="slide-out" class="button-collapse waves-effect waves-light"><i class="material-icons">menu</i></a>
            <ul class="left">
              <li><a data-activates="slide-out" class="open-side-nav hide-on-med-and-down"><i class="material-icons left">menu</i>Меню</a></li>
            </ul>
          </div>
        </nav>
      </div>

      <div class="container">
        <div class="row" id="menu_section">
          <div class="card col s12 black-text">
            <div class="center-align col s12">
              <h5>Разделы</h5>
            </div>
            <span class="col s4 center-align">
              <input name="chois" type="radio" id="user_sec" v-on:click="show_section(1)"/>
              <label for="user_sec">Пользователи</label>
            </span>
            <span class="col s4 center-align">
              <input name="chois" type="radio" id="article_sec" v-on:click="show_section(2)"/>
              <label for="article_sec">Статьи расходов</label>
            </span>
            <span class="col s4 center-align">
              <input name="chois" type="radio" id="department" v-on:click="show_section(3)"/>
              <label for="department">Отделы предприятия</label>
            </span>
           </div>
        </div>

        <div id="user" v-if="show" class="row">

          <div class="col s12 centre-preload" v-if="isload">
            <div class="preloader-wrapper active">
              <div class="spinner-layer spinner-blue-only">
                <div class="circle-clipper left">
                  <div class="circle"></div>
                </div><div class="gap-patch">
                  <div class="circle"></div>
                </div><div class="circle-clipper right">
                  <div class="circle"></div>
                </div>
              </div>
            </div>
          </div>

          <div v-if="!isload">

            <div class="col s12 red lighten-5 z-depth-1 header_section">
              <span class="col s12 right-align"><h5>Пользователь</h5></span>
            </div>

            <div class="col s6">
              <div class="input-field col s12">
                <input id="login" type="text" class="validate" pattern="[0-9a-zA-Z_-]{6,20}" v-model:value="login">
                <label for="login">Логин</label>
              </div>
              <p v-if="!new_user">
                <input name="passwd" type="radio" id="if_passwd" v-model:checked="change_passwd"/>
                <label for="if_passwd">Изменить пароль</label>
              </p>
              <div class="input-field col s12">
                <input id="passwd" type="password" class="validate" pattern="[0-9a-zA-Z_-]{6,20}" v-model:value="passwd">
                <label for="passwd">Пароль</label>
              </div>
              <div class="input-field col s12">
                <input id="again_passwd" type="password" class="validate" pattern="[0-9a-zA-Z_-]{6,20}" v-model:value="again_passwd">
                <label for="again_passwd">Повторите пароль</label>
              </div>
            </div>
            <div class="col s6">
              <div class="card col s12 black-text">
                <p class="red-text" v-if="error_art">{{message_dep}}</p>
                <p v-for="item in departments">
                  <input name="departments" type="radio" v-bind:id="item.id" v-on:click="show_department(item.id)"/>
                  <label v-bind:for="item.id">{{item.name}}</label>
                </p>
              </div>
              <table class="col s12" v-for="department in departments" v-show="department.table_show">
                <head>
                  <tr>
                    <th>ФИО</th>
                  </tr>
                </head>
                <tbody>
                  <tr v-for="item in department.employees">
                    <td><p>
                      <input name="users" type="radio" v-bind:id="item.id" v-model:checked="item.check"/>
                      <label v-bind:for="item.id">{{item.name}}</label>
                    </p></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="col s12">
              <div v-if="new_user">
                <a class="waves-effect waves-light btn" v-on:click="create_user"><i class="material-icons left">add</i>Создать</a>
              </div>
              <div v-if="!new_user">
                <a class="waves-effect waves-light btn light-blue darken-3" v-on:click="change_user"><i class="material-icons left">mode_edit</i>Изменить</a>
                <a class="waves-effect waves-light btn red accent-3" v-on:click="del_user"><i class="material-icons">delete</i>Удалить</a>
              </div>
            </div>
          </div>
        </div>


        <div id="users_section" v-if="show" class="row">

          <div class="col s12 red lighten-5 z-depth-1 header_section">
            <span class="col s1 center-align waves-effect head_icon" v-on:click="new_user"><i class="material-icons small">add</i></span>
            <span class="col s1 center-align waves-effect"><i class="material-icons small">search</i></span>
            <span class="col s10 right-align"><h5>Пользователи</h5></span>
          </div>
          <div class="z-depth-1">

            <div class="col s12 centre-preload" v-if="isload">
              <div class="preloader-wrapper active">
                <div class="spinner-layer spinner-blue-only">
                  <div class="circle-clipper left">
                    <div class="circle"></div>
                  </div><div class="gap-patch">
                    <div class="circle"></div>
                  </div><div class="circle-clipper right">
                    <div class="circle"></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row" v-if="loaderror">
                <p class="center-align col s12 red-text">{{message_error}}</p>
            </div>

            <table class="bordered highlight centered" v-if="loadtrue">
              <thead>
                <tr>
                  <th>Имя пользователя</th>
                  <th>Логин</th>
                  <th>Департамент</th>
                </tr>
              </thead>
              <tbody>
                <tr v-for="item in users" v-on:click="user_check(item.id)">
                  <td>{{item.name}}</td>
                  <td>{{item.login}}</td>
                  <td>{{item.department}}</td>
                </tr>
                <tr v-if="if_message" class="cyan lighten-5">
                  <td colspan="3"><span class="center-align">{{message}}</span></td>
                </tr>
                <tr v-if="add_load" class="indigo lighten-5">
                  <td></td>
                  <td class="centre-preload">
                    <div class="preloader-wrapper small active">
                      <div class="spinner-layer spinner-green-only">
                        <div class="circle-clipper left">
                          <div class="circle"></div>
                        </div><div class="gap-patch">
                          <div class="circle"></div>
                        </div><div class="circle-clipper right">
                          <div class="circle"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td></td>
                </tr>
                <tr v-if="!add_load" class="indigo lighten-5">
                  <td colspan="3"><span class="center-align" v-on:click="add_users">Загрузить следующие</span></td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>

      </div>



      <!--Окно отправить заявку-->
      <div id="user_window" class="modal">
        <div class="modal-content">
          <div class="row">
            <h5 class="cel s12 center-align ">Отправить данную заявку?</h5>
          </div>
          <div class="row">
            <div class="col s12 m12 l8 offset-l2">
              <p class="red-text">Внимание! После сохранения редактировать заявку нельзя</p>

              <p>Название: {{name}}</p>
              <p>Год: {{year}}</p>
              <p class="center-align green-text">{{message_success}}</p>
              <p class="center-align red-text">{{message_error}}</p>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <a class="modal-action modal-close waves-effect waves-red btn-flat">Отмена</a>
          <a class="modal-action waves-effect waves-green btn-flat" v-on:click="save">Отправить</a>
        </div>
      </div>

      <!--Боковое меню -->
      <ul id="slide-out" class="side-nav">
        <li><div class="userView">
          <img class="circle" src="img/user.png">
          <span class="name">{{name}}</span>
          <span class="email">{{department}}</span>
        </div></li>
        <li><div class="divider"></div></li>
        <li><a class="subheader">Меню</a></li>
        <li><a href="/" class="waves-effect">На главную</a></li>
        <!--<li><a href="#" class="waves-effect">Центр финансовой ответственности</a></li>
        <li><a href="#" class="waves-effect">ПЭД</a></li>-->
        <li><div class="divider"></div></li>
        <li><a href="/user/logout" class="waves-effect">Сменить пользователя</a></li>
      </ul>


      <script type="text/javascript" src="js/admin.js"></script>
      <script type="text/javascript">
        $(document).ready(function() {
          $('.modal').modal();
          $('input#name_load, input#year_load, input#year_load_check').characterCounter();
          $('select').material_select();
          $(".button-collapse").sideNav();
          $(".open-side-nav").sideNav();
          side_nav.onredys();
        });
      </script>
    </body>
  </html>
